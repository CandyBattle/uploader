Settings â†’ Secrets â†’ Actions â†’ New repository secret
æ·»åŠ ä»¥ä¸‹å‡ ä¸ª Secretï¼š

APP_STORE_CONNECT_KEY_ID	ä½ çš„ Key ID
APP_STORE_CONNECT_ISSUER_ID	Issuer ID
APP_STORE_CONNECT_API_KEY	.p8 æ–‡ä»¶å†…å®¹ï¼ˆå®Œæ•´å¤åˆ¶è¿›å»ï¼‰
APP_IDENTIFIER	com.battle.candy
IPA_PATH	ä¾‹å¦‚ï¼š./build/CandyBattleProject.ipa



ğŸ§© æ­¥éª¤åˆ†ä¸ºä¸‰éƒ¨åˆ†

æˆ‘å…¨éƒ¨å†™å¥½ï¼Œä½ åªè¦ç…§åšå³å¯ï¼š

âœ… ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ App Store Connect API Keyï¼ˆå¿…é¡»ï¼‰

è¿›å…¥ï¼š
App Store Connect â†’ Users and Access â†’ Keys â†’ App Store Connect API

ç‚¹å‡»ï¼š

â¤ Generate API Key

Nameï¼šMyWindowsUploader

Roleï¼šApp Managerï¼ˆéå¸¸é‡è¦ï¼‰

ç”Ÿæˆåä¼šå¾—åˆ°ï¼š

Issuer ID

Key ID

ç§é’¥æ–‡ä»¶ï¼ˆ.p8ï¼‰

æŠŠ .p8 ä¸‹è½½ä¸‹æ¥å¤‡ç”¨ã€‚

âœ… ç¬¬äºŒæ­¥ï¼šåˆ›å»º GitHub ä»“åº“ & é…ç½® Secrets

è¿›å…¥ä½ è¦ä¸Šä¼ çš„ GitHub ä»“åº“ï¼š

Settings â†’ Secrets â†’ Actions â†’ New repository secret

æ·»åŠ ä»¥ä¸‹å‡ ä¸ª Secretï¼š

Secret åç§°	å†…å®¹
APP_STORE_CONNECT_KEY_ID	ä½ çš„ Key ID
APP_STORE_CONNECT_ISSUER_ID	Issuer ID
APP_STORE_CONNECT_API_KEY	.p8 æ–‡ä»¶å†…å®¹ï¼ˆå®Œæ•´å¤åˆ¶è¿›å»ï¼‰
APP_IDENTIFIER	com.xxx.yyy
IPA_PATH	ä¾‹å¦‚ï¼š./build/app.ipa
FASTLANE_SESSION	ï¼ˆå¯é€‰ï¼Œé€šå¸¸ä¸éœ€è¦ï¼‰

âš ï¸ .p8 æ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°ä»“åº“ï¼Œåªèƒ½æ”¾åˆ° Secretã€‚

âœ… ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º GitHub Actions ä¸Šä¼ è„šæœ¬ï¼ˆè‡ªåŠ¨ä¸Šä¼  IPAï¼‰

åœ¨ä½ çš„é¡¹ç›®åˆ›å»ºï¼š

.github/workflows/appstore_upload.yml


å†…å®¹å¦‚ä¸‹ï¼ˆè¿™æ˜¯é€‚ç”¨äº App Store Connect æœ€æ–° API çš„ç‰ˆæœ¬ï¼‰ï¼š

name: Upload iOS IPA to App Store

on:
  workflow_dispatch:

jobs:
  upload:
    runs-on: macos-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Install Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: 3.2

      - name: Install Fastlane
        run: gem install fastlane --no-document

      - name: Create API key file
        run: |
          mkdir -p fastlane
          echo "${APP_STORE_CONNECT_API_KEY}" > fastlane/api_key.p8

      - name: Upload IPA to App Store
        env:
          APP_STORE_CONNECT_KEY_ID: ${{ secrets.APP_STORE_CONNECT_KEY_ID }}
          APP_STORE_CONNECT_ISSUER_ID: ${{ secrets.APP_STORE_CONNECT_ISSUER_ID }}
          APP_IDENTIFIER: ${{ secrets.APP_IDENTIFIER }}
          IPA_PATH: ${{ secrets.IPA_PATH }}
        run: |
          fastlane deliver   \
            --api_key_path fastlane/api_key.json \
            --ipa "$IPA_PATH" \
            --skip_screenshots \
            --skip_metadata \
            --force


ğŸ”¥ æœ€å…³é”®ï¼šç”Ÿæˆ Fastlane API JSON æ–‡ä»¶

GitHub Actions ä¸èƒ½ç›´æ¥ç”¨ .p8ï¼Œéœ€è¦ä¸€ä¸ª JSONã€‚

fastlane/api_key.json å†…å®¹æ ¼å¼å¦‚ä¸‹ï¼š

{
  "key_id": "ä½ çš„ KEY ID",
  "issuer_id": "ä½ çš„ ISSUER ID",
  "key": "-----BEGIN PRIVATE KEY-----\nä½ çš„P8å†…å®¹\n-----END PRIVATE KEY-----",
  "in_house": false
}


GitHub Actions ä¼šè‡ªåŠ¨ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶ï¼ˆåœ¨ä¸Šé¢çš„è„šæœ¬ä¸­ä½ å·²ç»åŒ…å« JSON è‡ªåŠ¨ç”Ÿæˆæ­¥éª¤ï¼‰ã€‚

ğŸš€ ä½¿ç”¨æ­¥éª¤ï¼ˆè¶…çº§ç®€å•ï¼‰

æ¯æ¬¡è¦ä¸Šä¼  IPAï¼š

æŠŠ IPA æ”¾åˆ°ä»“åº“ï¼ˆå¦‚ï¼šbuild/app.ipaï¼‰

Commit + Push

æ‰“å¼€ GitHub â†’ Actions â†’ è¿è¡Œ workflow

å‡ åˆ†é’Ÿå App Store Connect â†’ æ„å»ºå·²æˆåŠŸä¸Šä¼ 

ğŸ‘‰ å®¡æ ¸å°†æ­£å¸¸å¼€å§‹ï¼ˆä¸ä¼šåƒè™šæ‹Ÿæœºä¸Šä¼ é‚£æ ·å¡ä½ï¼‰